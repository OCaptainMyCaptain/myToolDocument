```
1、最核心问题开发对这个需求没太重视，没有做详细评审与关键代码review，测试没发现都还是次要的；
2、业务原定要求9.7日必须上线，后面又9.14上线，放大了紧迫程度；也请他们不要每次都是说必须如何，实际上他们也拼不动什么东西，连续加班他们也做不到，
一直以为IT是万能的也不太合适。
3、他们也是中间多次变更需求（实际上从来没有杜绝过），导致进度延迟。
4、对网金的后续活动要重视，请贤荣每次都邀请朱工、余洋军、黎工等做个最少完成概要设计，把关键点控制住，评审通过后在进行相关开发，而且可以邀请曹工部门的专业测试工程师支持一下，网金不太靠谱，出事都是我们的问题。
5、关键还是把自己的事情做好，让他们闭嘴。
 ```

```
1.关于复盘报告，时间线列得很详细，回答了“发生了什么”这个问题，还可以从技术细节层面具体回答“为什么会发生”、“能否提前发现预防”、“能否提高处置效率”、“后续有怎样的具体改进计划”等问题；
2.剑锋说得对，最核心的问题是我们的规范性遵循还不够，没有系统详细设计、设计评审和代码评审，目前需求很紧急的情况下做不到，不紧急的情况下仍然没有。
3.对于设计资金和实物卡券的相关的业务，敏感度还不够，我和坚哥多次在流程中提示异常监测，这些意见都没有落实。
4.对于时间紧和需求频繁变动的问题，第一我们必须按照开发制度和开发标准开展工作，大家如果加班加点工作仍不能完成，就要协商排期。第二近期引进一名需求管理岗工程师，后续类似需求发起讨论，必须由需求管理岗、部门负责人一起和开发工程师参加，我看第一次就贤荣一个人，其他全是网金人员。第三后续由需求管理岗统一与业务部门去交涉需求变动和排期变动，有困难的我和坚哥去协调，不能为了赶进度把同志们置于危地。
5.从案例来看，方案设计和测试有重大缺陷，最起码的已开户不能重复领，已发放的卡状态要准确变化，最基本的逻辑都有瑕疵。运维部要定期分析团队的能力短板类型，进行针对性的提高。
```


# 一、线上问题
1. 客户邀请他人参与活动并成功开户后没有获得京东卡和学习值
   - 业务场景：系统轮询邀请数据，调用非现场开户系统接口，查询被邀请客户是否开户成功。开户成功，则给邀请人发放京东卡以及学习值。
   - 问题分析：非现场开户系统接口内部查询逻辑以短信发送表为主表。今年百宝湘渠道上线百悟一键登录功能后，没有写短信发送表，也没有变更接口逻辑，导致通过百宝湘渠道一键登录进入开户系统的用户查询不到数据。
2. 客户邀请他人参与活动并成功开户后获得的京东卡数量大于应获得数量
   - 业务场景：系统轮询邀请数据，调用非现场开户系统接口，查询被邀请客户是否开户成功。开户成功，则给邀请人发放京东卡以及学习值。
   - 问题分析：
     - 轮询邀请数据发放京东卡任务每两分钟一次。
     - 调用的非现场开户系统接口是复用的，没有定制化，效率比较低，1秒钟大概只能处理5条数据。
     - 系统采用quartz框架处理定时任务。设定的时间一到，就会开启一个线程来轮询发放。
     - 系统没有考虑线程安全问题，导致多个线程处理了同一条数据，从而导致客户邀请他人参与活动并成功开户后获得的京东卡数量大于应获得数量
3. 一张京东卡发给了两个用户
   - 业务场景：系统轮询邀请数据，调用非现场开户系统接口，查询被邀请客户是否开户成功。开户成功，则给邀请人发放京东卡以及学习值。
   - 问题分析：
     - 京东卡表结构
        字段|类型|说明
        --:|:--:|:--
        SEQ_PRIZE_POOL_JD20_ID|NUMBER(20)|奖品池序列ID
        JD_PRIZE_KIND|VARCHAR2(32)|京东卡类别
        MONEY_VALUE|NUMBER(10,2)|金额
        CARD_NO|VARCHAR2(64)|卡号
        CARD_PASSWORD|VARCHAR2(64)|卡密
        VALID_DATE|VARCHAR2(128)|有效期
        STATUS|VARCHAR2(32)|状态
        INSERT_DATE|DATE|录入时间
        USED_STATUS|CHAR(1)|0:未使用，1:已使用
        USED_DATE|DATE|使用时间
     - 系统通过序列seq_prize_pool_jd20_id.nextval去匹配SEQ_PRIZE_POOL_JD20_ID来获取京东卡。
     - 京东卡表有个used_status字段，标识该京东卡是否已被使用。本次活动在发放京东卡后没有变更字段值。
     - 查看日志发现获取京东失败后，根据used_status字段查询剩余京东卡数量仍有大量可用京东卡。误认为是获取序列后，没有使用京东卡，故更改了used_status为可用的京东卡的SEQ_PRIZE_POOL_JD20_ID，导致了一张京东卡发给了两个客户。
4. 客户到京东激活京东卡时，提示京东卡已被激活
   - 业务场景：客户查询奖励，
5. 其他